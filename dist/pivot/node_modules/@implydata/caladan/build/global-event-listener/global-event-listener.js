"use strict";var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)};var React=require("react");var beltful_1=require("@implydata/beltful");var KEY_CODES={ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39};function enterKey(e){return e.which===KEY_CODES.ENTER}function escapeKey(e){return e.which===KEY_CODES.ESCAPE}function leftKey(e){return e.which===KEY_CODES.LEFT}function rightKey(e){return e.which===KEY_CODES.RIGHT}function alt(e){return e.altKey}var GlobalEventListener=function(_super){__extends(GlobalEventListener,_super);function GlobalEventListener(){_super.call(this);this.propsToEvents={resize:"resize",scroll:"scroll",mouseDown:"mousedown",mouseMove:"mousemove",mouseUp:"mouseup",keyDown:"keydown",keyUp:"keyup",altDown:"keydown",altUp:"keyup",enter:"keydown",escape:"keydown",right:"keydown",left:"keydown"};this.onResize=this.onResize.bind(this);this.onMousemove=this.onMousemove.bind(this);this.onMouseup=this.onMouseup.bind(this);this.onMousedown=this.onMousedown.bind(this);this.onKeydown=this.onKeydown.bind(this);this.onKeyup=this.onKeyup.bind(this);this.onScroll=this.onScroll.bind(this)}GlobalEventListener.prototype.componentWillReceiveProps=function(nextProps){this.refreshListeners(nextProps,this.props)};GlobalEventListener.prototype.componentDidMount=function(){this.refreshListeners(this.props)};GlobalEventListener.prototype.componentWillUnmount=function(){for(var prop in this.propsToEvents){this.removeListener(this.propsToEvents[prop])}};GlobalEventListener.prototype.refreshListeners=function(nextProps,currentProps){if(currentProps===void 0){currentProps={}}var toAdd=[];var toRemove=[];for(var prop in this.propsToEvents){var event_1=this.propsToEvents[prop];if(currentProps[prop]&&nextProps[prop])continue;if(nextProps[prop]&&toAdd.indexOf(event_1)===-1){toAdd.push(event_1)}else if(currentProps[prop]&&toRemove.indexOf(event_1)===-1){toRemove.push(event_1)}}toRemove.forEach(this.removeListener,this);toAdd.forEach(this.addListener,this)};GlobalEventListener.prototype.addListener=function(event){var useCapture=event==="scroll";window.addEventListener(event,this["on"+beltful_1.firstUp(event)],useCapture)};GlobalEventListener.prototype.removeListener=function(event){window.removeEventListener(event,this["on"+beltful_1.firstUp(event)])};GlobalEventListener.prototype.onResize=function(){if(this.props.resize)this.props.resize()};GlobalEventListener.prototype.onScroll=function(){if(this.props.scroll)this.props.scroll()};GlobalEventListener.prototype.onMousedown=function(e){if(this.props.mouseDown)this.props.mouseDown(e)};GlobalEventListener.prototype.onMousemove=function(e){if(this.props.mouseMove)this.props.mouseMove(e)};GlobalEventListener.prototype.onMouseup=function(e){if(this.props.mouseUp)this.props.mouseUp(e)};GlobalEventListener.prototype.onKeydown=function(e){if(this.props.escape&&escapeKey(e))this.props.escape(e);if(this.props.enter&&enterKey(e))this.props.enter(e);if(this.props.right&&rightKey(e))this.props.right(e);if(this.props.left&&leftKey(e))this.props.left(e);if(this.props.altDown&&alt(e)){this.isAltDown=true;this.props.altDown(e)}if(this.props.keyDown)this.props.keyDown(e)};GlobalEventListener.prototype.onKeyup=function(e){if(this.props.altUp&&this.isAltDown){this.isAltDown=false;this.props.altUp(e)}if(this.props.keyUp)this.props.keyUp(e)};GlobalEventListener.prototype.render=function(){return null};return GlobalEventListener}(React.Component);exports.GlobalEventListener=GlobalEventListener;