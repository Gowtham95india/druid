"use strict";var __extends=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function s(){this.constructor=e}e.prototype=t===null?Object.create(t):(s.prototype=t.prototype,new s)};var immutable_class_1=require("immutable-class");var settings_location_1=require("../settings-location/settings-location");function basicEqual(e,t){return Boolean(e)===Boolean(t)}var ServerSettings=function(e){__extends(t,e);function t(t){e.call(this,t);if(this.auth&&!(this.userMode==="external-users"||this.userMode==="external-users-and-session")){throw new Error("can not have auth with userMode "+this.userMode)}}t.isServerSettings=function(e){return e instanceof t};t.fromJS=function(e){if(typeof e.port==="string")e.port=parseInt(e.port,10);if(e.serverRoot&&e.serverRoot[0]!=="/")e.serverRoot="/"+e.serverRoot;if(e.serverRoot==="/")e.serverRoot=null;if(e.auth&&!e.userMode)e.userMode="external-users-and-session";return new t(immutable_class_1.BaseImmutable.jsToValue(t.PROPERTIES,e))};t.prototype.needsSession=function(){var e=this.getUserMode();return e==="native-users"||e==="external-users"};t.prototype.needsLogin=function(){var e=this.getUserMode();return e==="native-users"};t.prototype.externalUsers=function(){var e=this.getUserMode();return e==="external-users"||e==="external-users-and-session"};t.DEFAULT_PORT=9090;t.DEFAULT_SERVER_ROOT="/pivot";t.DEFAULT_REQUEST_LOG_FORMAT="common";t.DEFAULT_PAGE_MUST_LOAD_TIMEOUT=800;t.IFRAME_VALUES=["allow","deny"];t.DEFAULT_IFRAME="allow";t.TRUST_PROXY_VALUES=["none","always"];t.DEFAULT_TRUST_PROXY="none";t.STRICT_TRANSPORT_SECURITY_VALUES=["none","always"];t.DEFAULT_STRICT_TRANSPORT_SECURITY="none";t.USER_MODES=["all-users","all-admin","native-users","external-users","external-users-and-session"];t.DEFAULT_USER_MODE="all-admin";t.PROPERTIES=[{name:"port",defaultValue:t.DEFAULT_PORT,validate:immutable_class_1.BaseImmutable.ensure.number},{name:"serverHost",defaultValue:null},{name:"serverRoot",defaultValue:t.DEFAULT_SERVER_ROOT},{name:"requestLogFormat",defaultValue:t.DEFAULT_REQUEST_LOG_FORMAT},{name:"trackingUrl",defaultValue:null},{name:"trackingContext",defaultValue:null,equal:basicEqual},{name:"pageMustLoadTimeout",defaultValue:t.DEFAULT_PAGE_MUST_LOAD_TIMEOUT},{name:"iframe",defaultValue:t.DEFAULT_IFRAME,possibleValues:t.IFRAME_VALUES},{name:"trustProxy",defaultValue:t.DEFAULT_TRUST_PROXY,possibleValues:t.TRUST_PROXY_VALUES},{name:"strictTransportSecurity",defaultValue:t.DEFAULT_STRICT_TRANSPORT_SECURITY,possibleValues:t.STRICT_TRANSPORT_SECURITY_VALUES},{name:"auth",defaultValue:null},{name:"settingsLocation",defaultValue:null,immutableClass:settings_location_1.SettingsLocation},{name:"userMode",defaultValue:t.DEFAULT_USER_MODE,possibleValues:t.USER_MODES},{name:"sessionStore",defaultValue:null},{name:"sessionSecret",defaultValue:"You are not getting thorough here fool."},{name:"inviteStore",defaultValue:null},{name:"cookieMaxAge",defaultValue:2592e6},{name:"shaSalt",defaultValue:"Don't rub salt in your eyes!"}];return t}(immutable_class_1.BaseImmutable);exports.ServerSettings=ServerSettings;immutable_class_1.BaseImmutable.finalize(ServerSettings);