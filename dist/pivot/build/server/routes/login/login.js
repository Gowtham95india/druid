"use strict";var nike_hercules_1=require("@implydata/nike-hercules");var config_1=require("../../config");var user_1=require("../../../common/models/user/user");var COOKIE_MAX_AGE=config_1.SERVER_SETTINGS.getCookieMaxAge();var SHA_SALT=config_1.SERVER_SETTINGS.getShaSalt();var router=nike_hercules_1.HerculesServer.makeRouter();router.post("/",function(e,r,s){var t=e.body,o=t.name,n=t.pass,i=t.rememberMe;config_1.SETTINGS_MANAGER.getFullSettings({timeout:1e4}).then(function(s){if(!(typeof o==="string"&&typeof n==="string")){r.status(400).json({status:"BAD_REQUEST"});return}var t=s.appSettings.getUsers();user_1.User.getValidUser(t,o,n,SHA_SALT).then(function(s){if(!s){e.session["error"]="BAD_AUTH";r.status(401).json({status:"BAD_AUTH"});return}e.session["loggedIn"]=true;e.session["user"]=s;if(i){e.session.cookie.maxAge=COOKIE_MAX_AGE}r.json({status:"OK"})})})});module.exports=router;