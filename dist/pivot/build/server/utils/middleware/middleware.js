"use strict";var strings_1=require("../../../common/utils/constants/strings");var user_1=require("../../../common/models/user/user");var config_1=require("../../config");var views_1=require("../../views");function authenticatedOnly(e,n,t){if(e.session["loggedIn"]){if(!e.user)e["user"]=user_1.User.fromJS(e.session["user"]);t()}else{n.send(views_1.loginLayout({version:config_1.VERSION,title:strings_1.STRINGS.loginToPivot}))}}exports.authenticatedOnly=authenticatedOnly;function unauthenticatedOnly(e,n,t){if(e.session["loggedIn"]){n.redirect("/")}else{t()}}exports.unauthenticatedOnly=unauthenticatedOnly;function authorizationCheck(e){return function(n,t,s){var i=n.user.resources;if(!i)return s();if(i.indexOf("*")===-1&&i.indexOf(e)===-1){throw{status:404,message:"Not Found"}}else{s()}}}exports.authorizationCheck=authorizationCheck;exports.logout=function(e,n,t){e.session["loggedIn"]=false;n.redirect("/")};