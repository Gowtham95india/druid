"use strict";var __extends=this&&this.__extends||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i];function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)};var immutable_class_1=require("immutable-class");var immutable_class_2=require("immutable-class");var general_1=require("../../utils/general/general");var index_1=require("../index");var Collection=function(e){__extends(t,e);function t(t){e.call(this,t);if(!this.tiles)this.tiles=[]}t.isCollection=function(e){return e instanceof t};t.fromJS=function(e,i){if(!i)throw new Error("Collection must have context");if(!e.name)throw new Error("Collection must have a name");var n=e.tiles||e.items||e.linkItems||[];return new t({title:e.title,name:e.name,description:e.description,tiles:n.map(function(e){return index_1.CollectionTile.fromJS(e,i)})})};t.prototype.getDefaultTile=function(){return this.tiles[0]};t.prototype.isNameAvailable=function(e){return!this.getCollectionTile(e)};t.prototype.dependsOnDataCube=function(e){return this.tiles.some(function(t){return t.dataCube.name===e})};t.prototype.getCollectionTile=function(e){return immutable_class_2.NamedArray.findByName(this.tiles,e)};t.prototype.addOrUpdateTile=function(e){return this.changeTiles(immutable_class_2.NamedArray.overrideByName(this.tiles,e))};t.prototype.deleteTile=function(e){return this.changeTiles(immutable_class_2.NamedArray.deleteByName(this.tiles,e))};t.prototype.constrainTilesToDataCubes=function(e){return this.changeTiles(this.tiles.filter(function(t){return immutable_class_2.NamedArray.containsByName(e,t.dataCube.name)}))};t.PROPERTIES=[{name:"name",validate:general_1.verifyUrlSafeName},{name:"title",defaultValue:null},{name:"description",defaultValue:null},{name:"tiles",immutableClassArray:index_1.DataCube}];return t}(immutable_class_1.BaseImmutable);exports.Collection=Collection;immutable_class_1.BaseImmutable.finalize(Collection);