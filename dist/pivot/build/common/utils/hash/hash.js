"use strict";var Q=require("q");var SHA=require("jssha");var bcrypt=require("bcryptjs");var BCRYPT_SALT_ROUNDS=12;var SHA2_SALT="Don't rub salt in your eyes!";function saltedSha2(r,e){if(e===void 0){e=SHA2_SALT}return sha2(e+r)}exports.saltedSha2=saltedSha2;function sha2(r,e){if(e===void 0){e="B64"}var t=new SHA("SHA-256","TEXT");t.update(r);return t.getHash(e)}exports.sha2=sha2;function bcryptCompareSync(r,e){return bcrypt.compareSync(r,e)}exports.bcryptCompareSync=bcryptCompareSync;function bcryptHashSync(r,e){if(e===void 0){e=BCRYPT_SALT_ROUNDS}return bcrypt.hashSync(r,e)}exports.bcryptHashSync=bcryptHashSync;function bcryptHash(r,e){if(e===void 0){e=BCRYPT_SALT_ROUNDS}var t=Q.defer();bcrypt.hash(r,e,function(r,e){if(r)t.reject(r);t.resolve(e)});return t.promise}exports.bcryptHash=bcryptHash;function bcryptCompare(r,e){var t=Q.defer();bcrypt.compare(r,e,function(r,e){if(r)t.reject(r);t.resolve(e)});return t.promise}exports.bcryptCompare=bcryptCompare;