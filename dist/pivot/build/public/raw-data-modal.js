webpackJsonp([3],{933:function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};a(934);var o=a(6);var n=a(35);var l=a(440);var i=a(172);var s=a(176);var c=a(439);var d=a(426);var p=a(557);var u=a(777);var m=a(656);var f=a(684);var h=a(936);var v=a(414);var g=a(626);var w=30;var b=30;var y=100;var x=180;var S=100;var E=100;var N=200;function k(e){switch(e.type){case"BOOLEAN":return S;case"NUMBER":return E;case"TIME":return x;default:return N}}function C(e){return s.classNames(String(e.type).toLowerCase().replace(/\//g,"-"),{unsplitable:e.getUnsplitable()})}var R=function(e){r(t,e);function t(){e.call(this);this.state={loading:false,dataset:null,scrollLeft:0,scrollTop:0,error:null,stage:null};this.globalResizeListener=this.globalResizeListener.bind(this)}t.prototype.componentDidMount=function(){this.mounted=true;var e=this.props,t=e.essence,a=e.timekeeper;this.fetchData(t,a);this.globalResizeListener()};t.prototype.componentWillUnmount=function(){this.mounted=false};t.prototype.fetchData=function(e,t){var a=this;var r=e.dataCube;var o=c.$("main");var n=o.filter(e.getEffectiveFilter(t).toExpression()).limit(y);this.setState({loading:true});m.QueryRunner.fetch(r,n,e.timezone).then(function(e){if(!a.mounted)return;a.setState({dataset:e,loading:false})},function(e){if(!a.mounted)return;a.setState({error:e,loading:false})})};t.prototype.globalResizeListener=function(){var e=this.refs.table;var t=n.findDOMNode(e);if(!t)return;this.setState({stage:d.Stage.fromClientRect(t.getBoundingClientRect())})};t.prototype.onScroll=function(e,t){this.setState({scrollLeft:t,scrollTop:e})};t.prototype.getStringifiedFilters=function(){var e=this.props,t=e.essence,a=e.timekeeper;var r=t.dataCube;return t.getEffectiveFilter(a).clauses.map(function(e,o){var n=r.getDimension(e.dimension);if(!n)return null;var l=n.getKind()==="time"?t.evaluateClause(e,a):e;return f.formatFilterClause(n,l,t.timezone)})};t.prototype.renderFilters=function(){var e=o.createElement("li",{className:"limit",key:"limit"},"First ",y," events matching ");var t=this.getStringifiedFilters().map(function(e,t){return o.createElement("li",{className:"filter",key:t},e)});return[e].concat(t)};t.prototype.renderHeader=function(){var e=this.props.essence;var t=this.state.dataset;if(!t)return null;var a=e.dataCube;return a.getDimensions().map(function(e,t){var a=e.name;var r=k(e);var n={width:r};var l=a;return o.createElement("div",{className:s.classNames("header-cell",C(e)),style:n,key:t},o.createElement("div",{className:"title-wrap"},p.makeTitle(l)))})};t.prototype.getVisibleIndices=function(e,t){var a=this.state.scrollTop;return[Math.max(0,Math.floor(a/b)),Math.min(e,Math.ceil((a+t)/b))]};t.prototype.renderRows=function(){var e=this.props.essence;var t=this.state,a=t.dataset,r=t.scrollLeft,n=t.stage;if(!a)return null;var i=e.dataCube;var c=a.data;var d=this.getVisibleIndices(c.length,n.height),u=d[0],m=d[1];var f=c.slice(u,m);var v=i.getDimensions();var g=v.map(k);var w=h.getVisibleSegments(g,r,n.width),y=w.startIndex,x=w.shownColumns;var S=p.arraySum(g.slice(0,y));v=v.slice(y,y+x);var E=u*b;return f.map(function(e,t){var a=[];v.forEach(function(t){var r=t.name;var n=e[r];var i={width:k(t)};var c=n;if(l.isDate(e[r])){c=e[r].toISOString()}a.push(o.createElement("div",{className:s.classNames("cell",C(t)),key:r,style:i},o.createElement("span",{className:"cell-value"},String(c))))});var r={top:E,left:S};E+=b;return o.createElement("div",{className:"row",style:r,key:t},a)})};t.prototype.render=function(){var e=this.props,t=e.essence,a=e.timekeeper,r=e.onClose;var n=this.state,l=n.dataset,s=n.loading,c=n.error;var d=t.dataCube;var m=p.makeTitle(v.STRINGS.segment)+" "+v.STRINGS.rawData;var f=t.getEffectiveFilter(a).getFileString(d.getSpecialTimeDimension());var h={bodyWidth:p.arraySum(d.getDimensions().map(k)),bodyHeight:(l?l.data.length:0)*b,top:w,right:0,bottom:0,left:0};return o.createElement(g.Modal,{className:"raw-data-modal",title:m,onClose:r},o.createElement("div",{className:"content"},o.createElement("ul",{className:"filters"},this.renderFilters()),o.createElement(g.Scroller,{ref:"table",layout:h,topGutter:this.renderHeader(),body:this.renderRows(),onScroll:this.onScroll.bind(this)}),c?o.createElement(g.QueryError,{error:c}):null,s?o.createElement(g.Loader,null):null,o.createElement("div",{className:"button-bar"},o.createElement(i.Button,{type:"primary",className:"close",onClick:r,title:v.STRINGS.close}),o.createElement(i.Button,{type:"secondary",className:"download",onClick:u.download.bind(this,l,u.makeFileName(d.name,f,"raw"),"csv"),title:v.STRINGS.download,disabled:Boolean(s||c)}))))};return t}(o.Component);t.RawDataModal=R},934:function(e,t,a){var r=a(935);if(typeof r==="string")r=[[e.id,r,""]];var o=a(5)(r,{});if(r.locals)e.exports=r.locals;if(false){if(!r.locals){e.hot.accept("!!./../../../../node_modules/css-loader/index.js!./raw-data-modal.css",function(){var t=require("!!./../../../../node_modules/css-loader/index.js!./raw-data-modal.css");if(typeof t==="string")t=[[e.id,t,""]];o(t)})}e.hot.dispose(function(){o()})}},935:function(e,t,a){t=e.exports=a(3)();t.push([e.id,".raw-data-modal .content{position:absolute;top:60px;bottom:0;left:0;right:0;left:18px;right:18px;overflow:hidden}.raw-data-modal .content .filters{position:absolute;top:0;bottom:0;left:0;right:0;white-space:nowrap;overflow-x:hidden;text-overflow:ellipsis;height:30px;color:#999}.raw-data-modal .content .filters .limit,.raw-data-modal .content .filters .filter{font-size:13px;height:30px;display:inline}.raw-data-modal .content .filters .filter:not(:last-child)::after{content:'; '}.raw-data-modal .content .scroller{position:absolute;top:30px;bottom:66px;left:0;right:0;border:1px solid #dedede;cursor:auto}.raw-data-modal .content .scroller .row{height:30px;position:absolute;border-bottom:1px solid #dedede}.raw-data-modal .content .scroller .header-cell,.raw-data-modal .content .scroller .cell{white-space:nowrap;overflow-x:hidden;text-overflow:ellipsis;display:inline-block;height:100%;border-right:1px solid #dedede;padding-left:6px;padding-right:6px;padding-top:8px}.raw-data-modal .content .scroller .header-cell.unsplitable,.raw-data-modal .content .scroller .cell.unsplitable{background:#f5f5f5}.raw-data-modal .content .scroller .header-cell{background:#f5f5f5;height:30px;border-bottom:1px solid #dedede}.raw-data-modal .content .scroller .header-cell .title-wrap{white-space:nowrap;overflow-x:hidden;text-overflow:ellipsis;display:inline-block;width:100%;height:100%}.raw-data-modal .content .loader,.raw-data-modal .content .query-error{position:absolute;top:0;bottom:0;left:0;right:0}.raw-data-modal .content .button-bar{position:absolute;left:0;right:0;bottom:18px}\n",""])},936:function(e,t){"use strict";function a(e,t,a){var r=0;var o=0;var n=0;for(var l=0;l<e.length;l++){var i=e[l];var s=n+i;if(s<t){r++}else if(n<t+a){o++}n=s}return{startIndex:r,shownColumns:o}}t.getVisibleSegments=a}});